Index: ipsec-tools-cvs/src/racoon/pfkey.c
===================================================================
--- src/racoon/pfkey.c	2008-01-22 13:12:06.000000000 +0200
+++ src/racoon/pfkey.c	2008-01-22 13:14:47.000000000 +0200
@@ -2829,7 +2829,7 @@
 	struct sadb_msg buf, *newmsg;
 	int reallen;
 	int retry = 0;
-	
+
 	*lenp = -1;
 	do
 	{
@@ -2838,12 +2838,10 @@
 	    retry++;
 	}
 	while (*lenp < 0 && errno == EAGAIN && retry < 3);
+
 	if (*lenp < 0)
-	{
-	    if ( errno == EAGAIN ) *lenp = 0; /* non-fatal */
- 	    return NULL;	/*fatal*/
-	}
-	
+		return NULL;	/*fatal*/
+
 	else if (*lenp < sizeof(buf))
 		return NULL;
 
